unit UFrusuario;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, cxContainer, cxEdit, dxSkinsCore,
  dxSkinsDefaultPainters, Vcl.Menus, Data.DB, ZAbstractRODataset,
  ZAbstractDataset, ZDataset, cxGroupBox, cxRadioGroup, cxDBEdit,
  cxDropDownEdit, cxLookupEdit, cxDBLookupEdit, cxDBLookupComboBox, cxMaskEdit,
  cxSpinEdit, Vcl.Grids, Vcl.DBGrids, Vcl.StdCtrls, cxButtons, cxTextEdit,
  Vcl.ComCtrls;

type
  TFrusuario = class(TForm)
    PageControl1: TPageControl;
    TabSheet1: TTabSheet;
    Label1: TLabel;
    TxtValorPesquisa: TcxTextEdit;
    BtnPesquisa: TcxButton;
    DBGrid1: TDBGrid;
    TabSheet2: TTabSheet;
    Label2: TLabel;
    N: TLabel;
    lblcpfcnpj: TLabel;
    lblrgie: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    cxDBSpinEdit1: TcxDBSpinEdit;
    TxtNome: TcxDBTextEdit;
    cxDBTextEdit3: TcxDBTextEdit;
    cxDBTextEdit4: TcxDBTextEdit;
    cxDBTextEdit5: TcxDBTextEdit;
    cxDBTextEdit6: TcxDBTextEdit;
    cxDBTextEdit7: TcxDBTextEdit;
    cxDBTextEdit8: TcxDBTextEdit;
    lcestado: TcxDBLookupComboBox;
    lccidade: TcxDBLookupComboBox;
    cxDBMaskEdit1: TcxDBMaskEdit;
    BtnIncluir: TcxButton;
    BtnAlterar: TcxButton;
    BtnExcluir: TcxButton;
    BtnGravar: TcxButton;
    BtnCancelar: TcxButton;
    QueCidades: TZQuery;
    QueEstados: TZQuery;
    QueTabela: TZQuery;
    DataSource3: TDataSource;
    DataSource2: TDataSource;
    cbPessoa: TcxDBRadioGroup;
    DataSource1: TDataSource;
    QueTabelacodigo: TIntegerField;
    QueTabelanome: TWideStringField;
    QueTabelacpf: TWideStringField;
    QueTabelarg: TWideStringField;
    QueTabelaendereco: TWideStringField;
    QueTabelanumero: TWideStringField;
    QueTabelabairro: TWideStringField;
    QueTabelacomplemento: TWideStringField;
    QueTabelacep: TWideStringField;
    QueTabelacodigo_cidade: TIntegerField;
    QueTabelanome_cidade: TWideStringField;
    QueTabelacodigo_uf: TIntegerField;
    QueTabelanome_uf: TWideStringField;
    QueTabelasexo: TWideStringField;
    QueTabelatelefone: TWideStringField;
    QueTabelatelefone_contato: TWideStringField;
    procedure FormShow(Sender: TObject);
    procedure lcestadoPropertiesEditValueChanged(Sender: TObject);
    procedure AtivaDesativaBotoes;
    procedure BtnAlterarClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Frusuario: TFrusuario;

implementation

{$R *.dfm}
   uses uMed;


   procedure TFrusuario.AtivaDesativaBotoes;
begin
  BtnIncluir.Enabled := not BtnIncluir.Enabled;
  BtnExcluir.Enabled := not BtnExcluir.Enabled;
  BtnAlterar.Enabled := not BtnAlterar.Enabled;
  BtnCancelar.Enabled := not BtnCancelar.Enabled;
  BtnGravar.Enabled := not BtnGravar.Enabled;
end;


procedure TFrusuario.BtnAlterarClick(Sender: TObject);
begin
if not QueTabela.fieldByName('codigo').IsNull then
  Begin
    AtivaDesativaBotoes;
    QueTabela.Edit;
    TxtNome.SetFocus;
  End
  else
  begin
    ShowMessage('Nenhum registro Selecionado para Edição');
  end;
end;

procedure TFrusuario.FormShow(Sender: TObject);
begin
QueEstados.Active := True;
  QueCidades.Active := True;
  QueTabela.Open;
end;

procedure TFrusuario.lcestadoPropertiesEditValueChanged(Sender: TObject);
begin
 if BtnGravar.Enabled then
  begin
    if lcestado.Text <> '' then
    begin
      QueCidades.close;
      QueCidades.SQL.Clear;
      QueCidades.SQL.Add
        ('Select codigo_cidade,nome_cidade from cidades where sigla_estado = :pEst');
      QueCidades.ParamByName('pEst').AsString := trim(lcestado.Text);
      QueCidades.Open;

      QueCidades.Active := True;
    end;
  end;
end;

end.
